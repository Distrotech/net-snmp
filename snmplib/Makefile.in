#
# Makefile for snmplib
#

top_builddir	= ..

TARG=	libsnmp.$(LIB_EXTENSION)$(LIB_VERSION)
CLEANTARG = libsnmp.a

#all but md5.h, vacm.h, libsnmp.h, and read_config.h are copied to the installed
#include directory
INSTALLHEADERS=\
	asn1.h \
	callback.h \
	default_store.h \
	int64.h \
	keytools.h \
	mib.h \
	parse.h \
	read_config.h \
	scapi.h \
	snmp.h \
	snmp_alarm.h \
	snmp_api.h \
	snmp_client.h \
	snmp_debug.h \
	snmp_impl.h \
	snmp_logging.h \
	snmp_parse_args.h \
	snmpv3.h \
	system.h \
	tools.h \
	transform_oids.h \
	ucd-snmp-includes.h \
	@security_hdr_list@

CSRCS=	snmp_client.c               snmp_api.c snmp.c 		\
	snmp_auth.c asn1.c md5.c snmp_parse_args.c		\
	system.c vacm.c int64.c read_config.c 			\
	snmp_debug.c tools.c  snmp_logging.c			\
	snmpv3.c lcd_time.c keytools.c		                \
	scapi.c callback.c default_store.c snmp_alarm.c		\
	mt_support.c snmp_enum.c				\
	snprintf.c strtol.c strtoul.c				\
	snmp_transport.c @transport_src_list@                   \
	snmp_secmod.c @security_src_list@			\
	mib/mib_api.c mib/mib_conf.c				\
	mib/mib_dir.c mib/mib_module.c mib/mib_object.c		\
	varbind/oid.c varbind/value.c varbind/value_output.c	\
	varbind/varbind.c varbind/vblist.c			\
	utils/util_buffer.c utils/util_list.c			\
	ucd/ucd_mib_api.c ucd/ucd_varbind.c ucd/ucd_convert.c	\
	protocol/pdu.c protocol/encode.c			\
        community/packet.c

OBJS=	snmp_client.o               snmp_api.o snmp.o 		\
	snmp_auth.o asn1.o md5.o snmp_parse_args.o	  	\
	system.o vacm.o int64.o read_config.o 		  	\
	snmp_debug.o tools.o  snmp_logging.o	   	  	\
	snmpv3.o lcd_time.o keytools.o	  	                \
	scapi.o callback.o default_store.o snmp_alarm.o	  	\
	mt_support.o snmp_enum.o				\
	snprintf.o strtol.o strtoul.o				\
	snmp_transport.o @transport_obj_list@                   \
	snmp_secmod.o @security_obj_list@			\
	mib/mib_api.o mib/mib_conf.o				\
	mib/mib_dir.o mib/mib_module.o mib/mib_object.o		\
	varbind/oid.o varbind/value.o varbind/value_output.o	\
	varbind/varbind.o varbind/vblist.o			\
	utils/util_buffer.o utils/util_list.o			\
	ucd/ucd_mib_api.o ucd/ucd_varbind.o ucd/ucd_convert.o	\
	protocol/pdu.o protocol/encode.o			\
        community/packet.o

LOBJS=	snmp_client.lo                 snmp_api.lo snmp.lo 	\
	snmp_auth.lo asn1.lo md5.lo snmp_parse_args.lo		\
	system.lo vacm.lo int64.lo read_config.lo 		\
	snmp_debug.lo tools.lo  snmp_logging.lo	   	  	\
	snmpv3.lo lcd_time.lo keytools.lo	  	        \
	scapi.lo callback.lo default_store.lo snmp_alarm.lo	\
	mt_support.lo snmp_enum.lo				\
	snprintf.lo strtol.lo strtoul.lo			\
	snmp_transport.lo @transport_lobj_list@                 \
        snmp_secmod.lo @security_lobj_list@			\
	mib/mib_api.lo mib/mib_conf.lo				\
	mib/mib_dir.lo mib/mib_module.lo mib/mib_object.lo	\
	varbind/oid.lo varbind/value.lo varbind/value_output.lo	\
	varbind/varbind.lo varbind/vblist.lo			\
	utils/util_buffer.lo utils/util_list.lo			\
	ucd/ucd_mib_api.lo ucd/ucd_varbind.lo ucd/ucd_convert.lo\
	protocol/pdu.lo protocol/encode.lo			\
        community/packet.lo

# just in case someone wants to remove libtool, change this to OBJS.
TOBJS=$(LOBJS)

CFLAGS	 = @CFLAGS@
CPPFLAGS = -I. -I.. -I$(srcdir) -I$(srcdir)/.. @CPPFLAGS@

all: $(TARG)

libsnmp.$(LIB_EXTENSION)$(LIB_VERSION):    ${TOBJS}
	$(LIB_LD_CMD) libsnmp.$(LIB_EXTENSION)$(LIB_VERSION) ${TOBJS}
	$(RANLIB) libsnmp.$(LIB_EXTENSION)$(LIB_VERSION)

installdirs:
	@$(SHELL) $(srcdir)/../mkinstalldirs $(libdir) $(includedir)

install:	$(TARG) installdirs
	@for i in $(TARG) ; do $(INSTALL) $$i $(libdir) ; done
	@for i in $(INSTALLHEADERS) ; do $(INSTALL) $(srcdir)/$$i $(includedir) ; echo "install:  installed $$i in $(includedir)" ; done
	$(LIB_LDCONFIG_CMD)

../lib/libsnmp.$(LIB_EXTENSION)$(LIB_VERSION):	libsnmp.$(LIB_EXTENSION)$(LIB_VERSION)
	cp libsnmp.$(LIB_EXTENSION)$(LIB_VERSION) ../lib
	$(RANLIB) ../lib/libsnmp.$(LIB_EXTENSION)$(LIB_VERSION) $(LIB_LD_LIBS)

parse:  mib.o parse.c
	$(CC) $(CFLAGS) -DTEST parse.c mib.o -o parse

lint:
	lint -nhx $(CSRCS)

clean:
	rm -f ${OBJS} ${LOBJS} ${TARG} ${CLEANTARG}
	rm -rf .libs

depend: 
	makedepend $(CPPFLAGS) -o.lo $(srcdir)/*.c

nosysdepend:
	makedepend $(CPPFLAGS) -o.lo *.c
	perl -n -i.bak $(top_srcdir)/makenosysdepend.pl Makefile

makefileindepend: nosysdepend
	perl $(top_srcdir)/makefileindepend.pl

# DO NOT DELETE THIS LINE -- make depend depends on it.

asn1.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
asn1.lo:  asn1.h int64.h snmp_debug.h mib.h
asn1.lo: snmp_api.h snmp_impl.h
callback.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
callback.lo: ../m/generic.h  
callback.lo:   tools.h
callback.lo: callback.h asn1.h snmp_api.h snmp_debug.h
default_store.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
default_store.lo: ../m/generic.h 
default_store.lo:   asn1.h
default_store.lo: snmp_api.h snmp_debug.h snmp_logging.h
default_store.lo: tools.h read_config.h default_store.h system.h
int64.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
int64.lo: asn1.h int64.h
keytools.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
keytools.lo: ../m/generic.h  
keytools.lo:  asn1.h snmp_api.h
keytools.lo:  scapi.h keytools.h tools.h
keytools.lo: snmp_debug.h snmp_logging.h 
keytools.lo:  transform_oids.h
lcd_time.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
lcd_time.lo: ../m/generic.h  
lcd_time.lo:   asn1.h
lcd_time.lo: snmp_api.h callback.h snmpusm.h lcd_time.h snmp_debug.h tools.h
lcd_time.lo: scapi.h transform_oids.h
md5.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
md5.lo:   md5.h
mib.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
mib.lo: asn1.h snmp_api.h mib.h snmp.h snmp_impl.h parse.h int64.h system.h
mib.lo: read_config.h snmp_debug.h default_store.h
mt_support.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
mt_support.lo: ../m/generic.h  
mt_support.lo:  mt_support.h
parse.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
parse.lo: snmp_logging.h  
parse.lo:  system.h 
parse.lo:  parse.h asn1.h mib.h snmp_api.h
parse.lo: snmp_debug.h default_store.h tools.h
read_config.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
read_config.lo: ../m/generic.h  
read_config.lo:  ./getopt.h
read_config.lo:  asn1.h mib.h parse.h system.h
read_config.lo: snmp_api.h snmp_debug.h snmp_logging.h 
read_config.lo:  snmp_impl.h default_store.h
read_config.lo: callback.h read_config.h tools.h
scapi.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
scapi.lo:  asn1.h tools.h snmp_api.h callback.h
scapi.lo: snmpusm.h keytools.h snmp_debug.h scapi.h snmp_impl.h
scapi.lo:  system.h transform_oids.h
snmp.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
snmp.lo:   asn1.h snmp.h
snmp.lo: snmp_api.h snmp_impl.h snmp_logging.h 
snmp.lo:  snmp_debug.h mib.h
snmp_alarm.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snmp_alarm.lo: ../m/generic.h  
snmp_alarm.lo:  ./getopt.h 
snmp_alarm.lo:   asn1.h
snmp_alarm.lo: snmp_api.h snmp_debug.h tools.h default_store.h callback.h
snmp_alarm.lo: snmp_alarm.h
snmp_api.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snmp_api.lo: ../m/generic.h  
snmp_api.lo:  ./getopt.h 
snmp_api.lo:   asn1.h snmp.h
snmp_api.lo: snmp_api.h snmp_client.h snmp_impl.h parse.h mib.h system.h
snmp_api.lo: int64.h snmpv3.h read_config.h snmp_debug.h callback.h snmpusm.h
snmp_api.lo: tools.h keytools.h lcd_time.h snmp_alarm.h snmp_logging.h
snmp_api.lo:   default_store.h
snmp_api.lo: mt_support.h snmp-tc.h transform_oids.h
snmp_auth.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snmp_auth.lo: ../m/generic.h  
snmp_auth.lo:   asn1.h
snmp_auth.lo: snmp.h snmp_api.h snmp_impl.h mib.h md5.h system.h tools.h
snmp_auth.lo: snmp_debug.h scapi.h
snmp_client.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snmp_client.lo: ../m/generic.h  
snmp_client.lo: ./getopt.h  
snmp_client.lo:   asn1.h
snmp_client.lo: snmp.h snmp_api.h snmp_impl.h snmp_client.h mib.h
snmp_debug.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snmp_debug.lo: ../m/generic.h  
snmp_debug.lo:  asn1.h mib.h snmp_api.h
snmp_debug.lo: read_config.h snmp_debug.h snmp_impl.h snmp_logging.h
snmp_logging.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snmp_logging.lo: ../m/generic.h  
snmp_logging.lo:   asn1.h
snmp_logging.lo: default_store.h snmp_logging.h callback.h system.h
snmp_parse_args.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snmp_parse_args.lo: ../m/generic.h 
snmp_parse_args.lo:  ./getopt.h
snmp_parse_args.lo:  asn1.h snmp_api.h snmp_impl.h
snmp_parse_args.lo: snmp_client.h mib.h snmp.h scapi.h keytools.h
snmp_parse_args.lo: snmp_parse_args.h snmp_logging.h 
snmp_parse_args.lo:  ../version.h system.h parse.h
snmp_parse_args.lo: read_config.h snmp_debug.h snmpv3.h default_store.h
snmpusm.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snmpusm.lo: ../m/generic.h  
snmpusm.lo:   asn1.h
snmpusm.lo: snmp_api.h snmp_debug.h callback.h tools.h keytools.h snmp.h
snmpusm.lo: read_config.h snmpv3.h snmp-tc.h lcd_time.h scapi.h
snmpusm.lo: default_store.h snmpusm.h transform_oids.h
snmpv3.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
snmpv3.lo:  ./getopt.h 
snmpv3.lo:  system.h asn1.h snmpv3.h callback.h snmp.h
snmpv3.lo: snmp_api.h snmp_impl.h read_config.h lcd_time.h scapi.h tools.h
snmpv3.lo: keytools.h snmp_debug.h snmp_logging.h 
snmpv3.lo:  default_store.h snmpusm.h
snmpv3.lo: transform_oids.h
snprintf.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
snprintf.lo: ../m/generic.h
strtol.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
strtoul.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
strtoul.lo: ../m/generic.h
system.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
system.lo: ./getopt.h  
system.lo:   asn1.h snmp_api.h
system.lo: tools.h system.h snmp_logging.h 
testmib.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
testmib.lo: ../m/generic.h  
testmib.lo:  asn1.h mib.h
testutil.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h
testutil.lo: ../m/generic.h  
testutil.lo:  default_store.h
tools.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
tools.lo:   asn1.h
tools.lo: system.h snmp_api.h snmp_debug.h tools.h mib.h scapi.h
vacm.lo: ../config.h ../s/linux.h ../s/sysv.h ../s/generic.h ../m/generic.h
vacm.lo: ./getopt.h 
vacm.lo:  asn1.h snmp.h snmp_api.h vacm.h
vacm.lo: snmp_debug.h snmp-tc.h read_config.h default_store.h
